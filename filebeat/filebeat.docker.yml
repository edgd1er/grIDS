filebeat.config:
  modules:
    path: ${path.config}/modules.d/*.yml
    reload.enabled: false

setup.ilm:
  enabled: true
  overwrite: true

#filebeat.autodiscover:
#  providers:
#    - type: docker
#      hints.enabled: false
#      hints.default_config.enabled: false

processors:
  - add_host_metadata: ~
  - add_cloud_metadata: ~

#==================== Elasticsearch template setting ==========================
setup.template.settings:
  index.number_of_shards: 3

output.elasticsearch:
  hosts: [ "${ELASTICSEARCH_HOSTS:es01:9200}" ]
#  username: '${ELASTICSEARCH_USERNAME:}'
#  password: '${ELASTICSEARCH_PASSWORD:}'

#============================== Dashboards =====================================
setup.dashboards:
  enabled: true

#============================== Kibana =========================================
setup.kibana:
  host: "${KIBANA_HOST}:5601"
  username: ${ELASTICSEARCH_USERNAME}
  password: ${ELASTICSEARCH_PASSWORD}

#============================== Xpack Monitoring ===============================
monitoring:
  enabled: true
  elasticsearch:
    hosts: [ "${ELASTICSEARCH_HOSTS:es01:9200}" ]
    username: ${ELASTICSEARCH_USERNAME}
    password: ${ELASTICSEARCH_PASSWORD}

#============================= enable Module  ===================================
filebeat.modules:
  - module: suricata
  - module: system

#============================= inputs ===================================
filebeats.inputs:
- type: log
  paths:
      - /logs/suricata.log
      - /logs/eve.json